<!DOCTYPE html>
<html>
<head>
    <script src="angular.js"></script>
</head>
<body ng-app="ezstuff" ng-init="sb = {name:'somebody',gender:'male',age:28}">
<!-- 下面两个指令都绑定到变量sb上-->
<ez-namecard-editor data="sb"></ez-namecard-editor>
<div ez-logger data="sb"></div></body>
</html>
<script>

angular.module("ezstuff",[])
.directive("ezNamecardEditor",function(){
return {
restrict : "E",
template : "<ul class='nceditor'></ul>",
replace : true,
link : function(scope,element,attrs){
//获得变量名称
var model = attrs.data;

//展开HTML模板，使用field属性标记对应字段
element.append("<li>name : <input type='text' field='name'></li>")
.append("<li>gender : <input type='text' field='gender'></li>")
.append("<li>age : <input type='text' field='age'></li>");

//监听DOM事件，变化时修改变量值
element.find("input").on("keyup",function(ev){
var field = ev.target.getAttribute("field");
scope[model][field] = ev.target.value;
//将对scope的修改进行传播
scope.$apply("");    //直接修改对象，然后调用$apply方法来传播变化。
});
}
};
})
.directive("ezLogger",function(){
return {
restrict : "A",
link : function(scope,element,attrs){
var model = attrs.data;

scope.$watch(model,function(nv){
var cnt = JSON.stringify(nv,null,"	");
element.html("<pre>"+cnt+"</pre	");
			},true);
		}
	};
});
</script>